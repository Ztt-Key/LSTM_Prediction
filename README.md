# 🎵 优化版中文歌词预测系统

基于深度学习的中文歌词生成AI助手，使用优化的LSTM模型和多策略预测算法，输入一句歌词，AI为您创作高质量的下一句！

## ✨ 系统特色

- 🚀 **优化版LSTM模型**: 集成注意力机制，预测质量显著提升
- 🎯 **多策略预测**: AI模型 + 模板生成 + 规则预测，确保结果多样性
- 🎨 **智能质量控制**: 自动去重和质量过滤，避免低质量输出
- 🌐 **现代化Web界面**: 美观易用的前端交互，支持实时预测
- ⚡ **快速响应**: 优化的模型架构，秒级生成预测结果
- 🎭 **多种风格支持**: 古诗词、现代流行、励志、抒情等多种风格

## 🚀 快速启动指南

### 📋 环境要求

- **Python**: 3.9+ (已测试 Python 3.9)
- **系统支持**: Windows/Linux/MacOS
- **内存**: 建议 4GB+ RAM
- **存储**: 至少 500MB 可用空间

### 🔧 安装与配置

#### 1. 激活虚拟环境

```bash
# Windows
.\myenv\Scripts\activate

# Linux/MacOS  
source myenv/bin/activate
```

#### 2. 验证依赖安装

```bash
# 检查核心依赖
python -c "import torch, flask, jieba, numpy; print('✅ 所有依赖已安装')"
```

如果有缺失依赖，运行：
```bash
pip install -r requirements.txt
```

### 🎯 启动应用

```bash
# 启动Web应用
python web_app.py
```

启动成功后，您将看到：
```
✅ 优化版预测器初始化完成！
🌐 Web服务器启动中...
   * Running on http://127.0.0.1:5000
   * Running on http://192.168.x.x:5000
```

#### 🌐 访问应用

打开浏览器访问：
- **本地访问**: http://localhost:5000
- **局域网访问**: http://127.0.0.1:5000

## 📁 项目结构详解

```
LSTM_Prediction/
├── 🎯 核心应用文件
│   ├── web_app.py                    # Flask Web应用主程序
│   ├── optimized_lyrics_predictor.py # 优化版预测器核心算法
│   └── templates/
│       └── index.html               # 前端HTML模板
│
├── 🤖 AI模型文件  
│   ├── optimized_lyrics_model.pth   # 训练好的优化LSTM模型 (4.7MB)
│   ├── optimized_vocab.pkl          # 优化版词汇表 (1.4KB)
│   └── lyrics_data.json            # 训练数据集 (3.0KB)
│
├── 🔧 环境配置
│   ├── myenv/                       # Python虚拟环境
│   ├── requirements.txt             # 项目依赖列表
│   └── .git/                        # Git版本控制
│
└── 📖 项目文档
    └── README.md                    # 项目说明文档
```

## 🎮 使用指南

### 🎤 基本使用

1. **启动应用**: `python web_app.py`
2. **打开浏览器**: 访问 http://localhost:5000  
3. **输入歌词**: 在文本框中输入一句歌词
4. **获取预测**: 点击"预测下一句"按钮
5. **查看结果**: 系统将生成3个不同风格的预测结果

### 💡 输入示例

```
🎤 输入: "月亮代表我的心"
🎼 AI预测:
   1. 🤖 AI模型预测: 星星点点照亮夜空的梦
   2. 📝 模板生成: 温暖如春风拂过心田  
   3. 📋 规则预测: 深情如海洋无边无际
```

### 🎨 风格示例

**古诗词风格**:
- 输入: "春江花月夜"
- 输出: "明月几时有把酒问青天"

**现代流行风格**:
- 输入: "你是我心中"
- 输出: "最美的风景永不褪色"

**励志风格**:
- 输入: "相信自己"
- 输出: "勇敢追求心中的梦想"

## ⚙️ 核心技术架构

### 🧠 优化版LSTM模型

```python
# 模型架构特点
- 嵌入维度: 128
- 隐藏层维度: 256  
- LSTM层数: 2
- 注意力头数: 4
- Dropout率: 0.3
```

**技术创新**:
- **多头注意力机制**: 提升上下文理解能力
- **双向LSTM**: 更好地捕获序列特征
- **梯度裁剪**: 防止梯度爆炸，训练更稳定
- **自适应学习率**: 优化训练收敛速度

### 🎯 多策略预测算法

#### 1. 🤖 AI模型预测
- 基于训练好的LSTM神经网络
- 使用温度采样和Top-k采样
- 动态调整生成参数

#### 2. 📝 模板生成  
- 预定义高质量歌词模板
- 智能词汇分类填充
- 情感、时间、地点等维度组合

#### 3. 📋 规则预测
- 基于语言学规则的生成
- 作为备用生成策略
- 确保始终有可用输出

### 🔍 质量控制机制

- **去重算法**: 自动过滤重复预测
- **长度控制**: 确保输出合理长度  
- **语义检查**: 基本语义合理性验证
- **多样性保证**: 不同策略确保结果差异化

## 🌐 Web界面功能

### 🎨 界面特色

- **响应式设计**: 支持PC、平板、手机访问
- **实时状态显示**: 系统状态和模型加载进度
- **优雅动画效果**: 流畅的交互体验
- **智能示例提示**: 提供输入示例参考

### 🔧 功能按钮

- **🔮 预测下一句**: 核心预测功能
- **🎯 重新训练模型**: 使用当前数据重新训练
- **💡 示例填充**: 快速填入示例歌词
- **📊 系统状态**: 查看模型状态和可用性

### 📱 技术栈

- **后端**: Flask + Python
- **前端**: HTML5 + CSS3 + JavaScript
- **AI框架**: PyTorch
- **分词工具**: jieba
- **数据处理**: NumPy + Pandas

## 🔄 模型训练

### 📊 训练数据

系统使用精心整理的中文歌词数据集:
- **古诗词**: 经典诗词改编
- **民歌**: 传统民谣
- **现代歌词**: 流行音乐风格
- **励志歌词**: 正能量内容
- **总数据量**: 49条精选歌词

### 🎯 训练参数

```python
# 推荐训练配置
epochs = 60          # 训练轮数
batch_size = 16      # 批次大小  
learning_rate = 0.001 # 学习率
seq_length = 12      # 序列长度
```

### 🔄 重新训练

如需重新训练模型：
1. 点击Web界面的"重新训练模型"
2. 等待训练完成（约3-5分钟）
3. 系统自动加载新模型

## 🚨 常见问题解决

### ❌ NumPy兼容性问题

**问题**: `Numpy is not available` 或版本冲突
**解决方案**:
```bash
pip uninstall numpy -y
pip install "numpy<2.0"
```

### ❌ 模型文件不存在

**问题**: 找不到模型文件
**解决方案**: 
1. 确保 `optimized_lyrics_model.pth` 存在
2. 如不存在，启动应用会自动训练

### ❌ 端口占用

**问题**: 5000端口被占用
**解决方案**: 修改 `web_app.py` 中的端口:
```python
app.run(debug=True, host='0.0.0.0', port=5001)
```

### ❌ 虚拟环境问题

**问题**: 依赖找不到
**解决方案**: 确保正确激活虚拟环境:
```bash
.\myenv\Scripts\activate  # Windows
source myenv/bin/activate # Linux/Mac
```

## 🎯 性能优化建议

### 💾 内存优化
- 模型大小仅4.7MB，内存占用低
- 支持CPU推理，无需GPU
- 优化的词汇表减少内存使用

### ⚡ 速度优化  
- 预编译的jieba词典
- 批量预测支持
- 智能缓存机制

### 🔧 模型优化
- 量化压缩支持
- 动态批次大小
- 自适应序列长度

## 🔮 后续发展计划

### 🎵 功能扩展
- [ ] 支持更多歌词风格
- [ ] 添加情感倾向控制
- [ ] 集成语音输入输出
- [ ] 支持多语言预测

### 🚀 技术升级
- [ ] 升级到Transformer架构
- [ ] 引入预训练语言模型
- [ ] 增加强化学习优化
- [ ] 支持GPU加速推理

### 🌐 应用扩展
- [ ] 移动端APP开发
- [ ] API接口开放
- [ ] 插件形式集成
- [ ] 云端部署支持

## 🤝 贡献指南

欢迎参与项目贡献！

### 📝 如何贡献
1. **Fork项目**: 创建项目副本
2. **创建分支**: `git checkout -b feature/新功能`
3. **提交代码**: `git commit -m "添加新功能"`
4. **推送分支**: `git push origin feature/新功能`
5. **创建PR**: 提交Pull Request

### 🎯 贡献方向
- 🐛 Bug修复和问题报告
- ✨ 新功能开发
- 📚 文档完善
- 🎨 界面优化
- ⚡ 性能提升

## 📄 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 🙏 致谢

- **PyTorch团队**: 提供优秀的深度学习框架
- **jieba项目**: 优秀的中文分词工具
- **Flask团队**: 轻量级Web框架
- **所有贡献者**: 感谢每一位参与者的支持

## 📞 联系方式

如有问题或建议，欢迎通过以下方式联系：

- **Issues**: 在GitHub提交问题
- **讨论**: 在项目讨论区交流
- **邮件**: [在此添加邮箱]

---

**🎵 让AI为您的创作插上翅膀！**
